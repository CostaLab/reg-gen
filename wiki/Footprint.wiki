#summary Prediction of transcription factor binding sites using HMMs on DNase-seq and histone modification ChIP-seq data.

= Footprints =

Command: *rgt-footprint*

== Method ==

We propose an HMM-based approach to integrate both DNase I hypersensitivity and histone modifications for the detection of open chromatin regions and active binding sites.

Within transcription factor binding sites, there is a specific grammar of DNase I digestion and histone marks. We have therefore devised a multivariate HMM to model this regulatory grammar by simultaneous analysis of DNase-seq and the ChIP-seq profiles of H3K4me3 (indicative of promoters) or H3K4me1 (indicative of enhancers) on a genome-wide level.

The HMM has as input a normalized and a slope signal of DNase-seq and one of the histone marks. It can therefore detect the increase, top and decrease regions of either histone modification and DNase signals. The genomic regions annotated with the 'footprint' HMM state are considered our predictions and represent likely binding sites within that cell's context.

== Requirements ==

This tool requires a few extra Python packages:
  * [http://www.numpy.org/ numpy]
  * [http://www.scipy.org/ scipy] 
  * [http://scikit-learn.org/stable/ scikit]
  * [http://code.google.com/p/pysam/ pysam]

If you have sudo privileges, the first three packages from the list above can be installed with the following commands:
{{{
sudo apt-get install build-essential python-dev python-numpy python-setuptools python-scipy libatlas-dev libatlas3-base
pip install -U scikit-learn
}}}

However, if you are not the administrator. Please visit the project's websites by clicking in the links above and search for the python installation with the "prefix" scheme.

== Installation ==

Given that you have all the required packages. The tool can be easily installed locally by executing the following commands:
{{{
# Installing subversion (SVN)
apt-get install subversion

# Downloading code and change to the code's directory.
svn checkout http://reg-gen.googlecode.com/svn/trunk/ ~/reg-gen/
cd ~/reg-gen/

# Setting up environmental variables for local installation
# Please also add the following two lines to your ~/.bashrc file.
export PATH=$PATH:~/app/bin/
export PYTHONPATH=$PYTHONPATH:~/app/lib/pythonX.X/:~/app/lib64/pythonX.X/

# Installation command
python setup.py install --prefix=~/app --rgt-tool=footprint
}}}

For more details on the installation please go to the [https://code.google.com/p/reg-gen/wiki/Installation installation] section.

== Input ==

In order to use this tools, please type:
{{{
rgt-footprint [options] <experiment_matrix>
}}}

Below you will find detailed instructions for all the available `options`. In the following section, we provide detailed explanation on the format of all RGT-specific input files.

All options are used in the format: `--option=value`. Except `BOOL` options, which are used only as a flag `--option`.

==== Required Input: ====

The tool requires only one experimental matrix file.

The `experiment matrix` should contain:
  * One 'regions' file representing the regions in which the HMM will be applied. It should contain 'regions' in the TYPE field.
  * One DNase aligned reads file (bam) file with 'DNASE' in the NAME field and 'reads' in the TYPE field.
  * One to Three histone modification aligned reads file (bam) with 'reads' in the TYPE field.

==== Optional Input: ====

|| *Option name* || *Type* || *Default* || *Description* ||
|| --hmm-file || FILE_1[,FILE_2,...,FILE_N] || Internal HMM file trained using data from <br> DNase+H3K4me3 in cell type K562 || List of HMM files separated by comma. If one file only, then this HMM will be applied for all histone signals, otherwise, the list must have the same number of histone files given. The order of the list should be the order of the histones in the input_matrix file. ||

==== Optional Parameters: ====

|| *Option name* || *Type* || *Default* || *Description* ||
|| --organism || STRING || hg19 || Organism considered on the analysis. Currently we made available human (hg19) and mouse (mm9). All default files such as genomes will be based on the chosen organism and the data.config file. This option is used only if a bigbed output is asked. ||

==== Optional Output: ====

|| *Option name* || *Type* || *Default* || *Description* ||
|| --output-location || PATH || Current directory || Path where the output files will be written. ||
|| --footprint-name || STRING || footprints || Name of the footprint file (without extension). ||
|| --print-bb || BOOL || Option is not used || If used, the output will be a bigbed (.bb) file. For this option to run successfully, you must have the [http://hgdownload.cse.ucsc.edu/admin/exe/linux.x86_64/bedToBigBed bedToBigBed] script from UCSC utilities in any folder in your `$PATH` variable. ||

== RGT-specific Input Format Definition ==

=== Experimental Matrix ===

Under construction.

=== HMM File ===

Under construction.

== Output ==

Under construction.

== Example ==

We provide an example of the application of the footprint tool in DNase Hypersensitive regions of the human chromosome 22. The example contains aligned reads (.bam files) for DNase-seq and ChIP-seq for histone modifications H3K4me1 and H3K4me3. Also, it contains the DNase Hypersensitive regions (.bed file) and a set-up experimental matrix. A proper execution will generate a file called `footprints.bed` in the `Output` folder.

You can download an example containing all the required input data in the correct format and run it with the following commands:

{{{
# Downloading file and changing to example's directory
wget -P ~/ <TODO XXX>
cd ~
tar -zxvf RGT_Footprint_Test.tar.gz
cd ~/RGT_Footprint_Test/

# Running the footprint tool
rgt-footprint --output-location ./Output/ ./InputMatrix.txt
}}}

This example contains about 290 MB and takes about 25 minutes to run.